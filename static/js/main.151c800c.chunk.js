(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{15:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),c=a(7),i=a.n(c),r=(a(15),a(10)),s=a(2),l=Object(n.createContext)(),u=a(0);var d=function(){return Object(u.jsx)("header",{className:"header",children:Object(u.jsx)("div",{className:"header__logo"})})},p=a(6);var m=function(e){var t=Object(n.useContext)(l),a=e.owner._id===t._id,o=e.likes.some((function(e){return e._id===t._id})),c="element__button-delete ".concat(a?"element__button-delete_active":""),i="element__button-like ".concat(o?"element__button-like_active":"");return Object(u.jsxs)("li",{className:"element",children:[Object(u.jsx)("button",{className:c,type:"button","aria-label":"\u0443\u0434\u0430\u043b\u0438\u0442\u044c",onClick:function(){e.onCardDeletePopup(e)}}),Object(u.jsx)("img",{className:"element__image",src:e.link,alt:e.name,onClick:function(){e.onCardClick(e)}}),Object(u.jsxs)("div",{className:"element__container",children:[Object(u.jsx)("h2",{className:"element__title",children:e.name}),Object(u.jsxs)("div",{className:"element__container-like",children:[Object(u.jsx)("button",{className:i,type:"button","aria-label":"\u043d\u0440\u0430\u0432\u0438\u0442\u0441\u044f",onClick:function(){e.onCardLike(e)}}),Object(u.jsx)("span",{className:"element__like-counter",id:"like-counter",children:e.likes.length})]})]})]})};var j=function(e){return Object(u.jsxs)("section",{className:"loading ".concat(e.isLoading?"loading_active":""),children:[Object(u.jsx)("div",{className:"loading__picture",style:{backgroundImage:"url(".concat(e.loadingData.image,")"),width:"".concat(e.loadingData.width),height:"".concat(e.loadingData.height)}}),Object(u.jsx)("h3",{className:"loading__title",children:e.loadingData.name})]})};var b=function(e){var t=Object(n.useContext)(l);return Object(u.jsxs)("main",{className:"content",children:[Object(u.jsx)(j,{isLoading:e.isLoading,loadingData:e.loadingData}),Object(u.jsxs)("section",{className:"profile",children:[Object(u.jsxs)("div",{className:"profile__content",children:[Object(u.jsxs)("div",{className:"profile__avatar-container",children:[Object(u.jsx)("div",{className:"profile__avatar",style:{backgroundImage:"url(".concat(t.avatar,")")},"aria-label":"\u0430\u0432\u0430\u0442\u0430\u0440\u043a\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"}),Object(u.jsx)("button",{className:"profile__edit-button profile__edit-button_place_avatar","aria-label":"\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",type:"button",onClick:e.onEditAvatar})]}),Object(u.jsxs)("div",{className:"profile__container",children:[Object(u.jsxs)("div",{className:"profile__title-container",children:[Object(u.jsx)("h1",{className:"profile__title",children:t.name}),Object(u.jsx)("button",{className:"link-opacity profile__edit-button","aria-label":"\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",type:"button",onClick:e.onEditProfile})]}),Object(u.jsx)("p",{className:"profile__subtitle",children:t.about})]})]}),Object(u.jsx)("button",{className:"link-opacity profile__add-button","aria-label":"\u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c",type:"button",onClick:e.onAddPlace})]}),Object(u.jsx)("section",{className:"elements",children:Object(u.jsx)("ul",{className:"elements__container",children:e.cards.map((function(t){return Object(u.jsx)(m,Object(p.a)(Object(p.a)({},t),{},{onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDeletePopup:e.onCardDeletePopup}),t._id)}))})})]})};var _=function(){return Object(u.jsx)("footer",{className:"footer",children:Object(u.jsx)("p",{className:"footer__title",children:"\xa9 2021. Valerii Borisenko"})})};var f=function(e){return Object(u.jsx)("section",{className:"popup popup_place_image ".concat(e.isOpen?"popup_visible":"popup"),children:Object(u.jsxs)("figure",{className:"popup__window popup__window_place_image",children:[Object(u.jsx)("button",{className:"link-opacity popup__close-button",type:"button","aria-label":"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",onClick:e.onClose}),Object(u.jsx)("img",{className:"popup__image",src:e.card.link,alt:e.card.name}),Object(u.jsx)("figcaption",{className:"popup__title popup__title_place_image",children:e.card.name})]})})};var v=function(e){return Object(u.jsx)("section",{className:"popup popup_place_".concat(e.name," ").concat(e.isOpen?"popup_visible":"popup"),children:Object(u.jsxs)("div",{className:"popup__window popup__window_place_".concat(e.name),children:[Object(u.jsx)("button",{className:"link-opacity popup__close-button",type:"button","aria-label":"\u0437\u0430\u043a\u0440\u044b\u0442\u044c",onClick:e.onClose}),Object(u.jsx)("h2",{className:"popup__title",children:e.title}),Object(u.jsxs)("form",{className:"popup__form popup__form_place_".concat(e.name),name:e.name,noValidate:!0,onSubmit:e.onSubmit,children:[e.children,Object(u.jsx)("button",{className:"popup__save-button ".concat(e.saveButtonInvalid),type:"submit",onClick:e.saveButtonClick,children:e.saveButton})]})]})})};var h=function(e){var t=Object(n.useContext)(l),a=Object(n.useState)(""),o=Object(s.a)(a,2),c=o[0],i=o[1],r=Object(n.useState)(""),d=Object(s.a)(r,2),p=d[0],m=d[1];return Object(n.useEffect)((function(){t.name&&t.about&&(i(t.name),m(t.about))}),[t]),Object(u.jsxs)(v,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:c,about:p}),t.target.reset()},saveButton:e.saveButton.saveProfile,saveButtonInvalid:e.saveButton.invalid,saveButtonClick:e.saveButtonClick,children:[Object(u.jsx)("input",{className:"popup__form-text popup__form-text_type_profile-name",type:"text",id:"name-profile",name:"name",required:!0,placeholder:"\u0418\u043c\u044f",minLength:"2",maxLength:"40",autoComplete:"off",value:c,onChange:function(e){i(e.target.value)}}),Object(u.jsx)("span",{className:"error error_place_name-error",id:"name-profile-error"}),Object(u.jsx)("input",{className:"popup__form-text popup__form-text_type_profile-about",type:"text",id:"about",name:"about",required:!0,placeholder:"\u041e \u0441\u0435\u0431\u0435",minLength:"2",maxLength:"200",autoComplete:"off",value:p,onChange:function(e){m(e.target.value)}}),Object(u.jsx)("span",{className:"error error_place_about-error",id:"about-error"})]})};var O=function(e){var t=Object(n.useRef)("");return Object(u.jsxs)(v,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onUpdateAvatar({avatar:t.current.value}),a.target.reset()},saveButton:e.saveButton.saveAvatar,saveButtonInvalid:e.saveButton.invalid,saveButtonClick:e.saveButtonClick,children:[Object(u.jsx)("input",{className:"popup__form-text popup__form-text_type_avatar",type:"url",id:"avatar",name:"avatar",required:!0,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",autoComplete:"off",ref:t}),Object(u.jsx)("span",{className:"error error_place_avatar-error",id:"avatar-error"})]})};var x=function(e){var t=Object(n.useRef)(""),a=Object(n.useRef)("");return Object(u.jsxs)(v,{name:"element",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onAddPlace({name:t.current.value,link:a.current.value}),n.target.reset()},saveButton:e.saveButton.addImage,saveButtonInvalid:e.saveButton.invalid,saveButtonClick:e.saveButtonClick,children:[Object(u.jsx)("input",{ref:t,className:"popup__form-text popup__form-text_type_element-name",type:"text",id:"name-card",name:"name",required:!0,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"2",maxLength:"30",autoComplete:"off"}),Object(u.jsx)("span",{className:"error error_place_image-name-error",id:"name-card-error"}),Object(u.jsx)("input",{ref:a,className:"popup__form-text popup__form-text_type_image",type:"url",id:"link",name:"link",required:!0,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",autoComplete:"off"}),Object(u.jsx)("span",{className:"error error_place_image-error",id:"link-error"})]})};var g=function(e){return Object(u.jsx)(v,{name:"delete-card",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onCardDelete(e.card)},saveButton:e.saveButton.delete,saveButtonInvalid:e.saveButton.invalid,saveButtonClick:e.saveButtonClick})},C=a.p+"static/media/loading.b2a8fa3d.gif",k=a.p+"static/media/error.588ef598.gif",N=function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))},y={saveProfile:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",saveAvatar:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",addImage:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",delete:"\u0414\u0430",invalid:""},B={saveProfile:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...",saveAvatar:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...",addImage:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...",delete:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435...",invalid:"popup__save-button_state_invalid"},S={saveProfile:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u0438 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",saveAvatar:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 url \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438",addImage:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0438 url \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438",invalid:"popup__save-button_state_error"},w={loading:{image:C},error:{image:k,width:"300px",height:"300px",name:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a \u0438 \u043c\u044b \u0443\u0436\u0435 \u043f\u0440\u0438\u043a\u043b\u0430\u0434\u044b\u0432\u0430\u0435\u043c \u043f\u043e\u0434\u043e\u0440\u043e\u0436\u043d\u0438\u043a"}},L=a(8),D=a(9),E=new(function(){function e(t){var a=t.url,n=t.headers;Object(L.a)(this,e),this._url=a,this._headers=n}return Object(D.a)(e,[{key:"getUserData",value:function(){return fetch("".concat(this._url,"users/me"),{method:"GET",headers:this._headers}).then(N)}},{key:"getAllCards",value:function(){return fetch("".concat(this._url,"cards"),{method:"GET",headers:this._headers}).then(N)}},{key:"changeLikeCardStatus",value:function(e,t){return fetch("".concat(this._url,"cards/likes/").concat(e),{method:"".concat(t?"PUT":"DELETE"),headers:this._headers}).then(N)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._url,"cards/").concat(e),{method:"DELETE",headers:this._headers}).then(N)}},{key:"setUserInfo",value:function(e){return fetch("".concat(this._url,"users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(N)}},{key:"setUserAvatar",value:function(e){return fetch("".concat(this._url,"users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(N)}},{key:"setNewCard",value:function(e){return fetch("".concat(this._url,"cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(N)}}]),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-20/",headers:{"content-type":"application/json",authorization:"a4e2a7e9-e2ca-4fbc-8dff-1e2c4b21f19a"}});var P=function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(!1),i=Object(s.a)(c,2),p=i[0],m=i[1],j=Object(n.useState)(!1),v=Object(s.a)(j,2),C=v[0],k=v[1],N=Object(n.useState)(!1),L=Object(s.a)(N,2),D=L[0],P=L[1],A=Object(n.useState)(!1),I=Object(s.a)(A,2),U=I[0],T=I[1],q=Object(n.useState)(!1),J=Object(s.a)(q,2),R=J[0],G=J[1],H=Object(n.useState)(""),V=Object(s.a)(H,2),z=V[0],M=V[1],F=Object(n.useState)([]),K=Object(s.a)(F,2),Q=K[0],W=K[1],X=Object(n.useState)(!0),Y=Object(s.a)(X,2),Z=Y[0],$=Y[1],ee=Object(n.useState)(w.loading),te=Object(s.a)(ee,2),ae=te[0],ne=te[1],oe=Object(n.useState)(y),ce=Object(s.a)(oe,2),ie=ce[0],re=ce[1];function se(){re(B)}function le(){o(!1),k(!1),m(!1),P(!1),T(!1),re(y)}return Object(n.useEffect)((function(){Promise.all([E.getUserData(),E.getAllCards()]).then((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];M(a),W(n)})).then((function(){return $(!1)})).catch((function(e){console.log(e),setTimeout((function(){return ne(w.error)}),1e4)}))}),[]),Object(n.useEffect)((function(){var e=function(e){e.target.classList.contains("popup_visible")&&le()},t=function(e){"Escape"===e.key&&le()};return!0===(a||p||C||D||U)&&(window.addEventListener("click",e),window.addEventListener("keyup",t)),function(){window.removeEventListener("click",e),window.removeEventListener("keyup",t)}}),[a,p,C,D,U]),Object(u.jsx)(l.Provider,{value:z,children:Object(u.jsxs)("div",{className:"app",children:[Object(u.jsx)(d,{}),Object(u.jsx)(b,{onEditAvatar:function(){m(!0)},onEditProfile:function(){o(!0)},onAddPlace:function(){k(!0)},onCardClick:function(e){G(e),P(!0)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===z._id}));E.changeLikeCardStatus(e._id,!t).then((function(t){W((function(a){return a.map((function(a){return a._id===e._id?t:a}))}))})).catch((function(e){console.log(e)}))},onCardDeletePopup:function(e){G(e),T(!0)},cards:Q,isLoading:Z,loadingData:ae}),Object(u.jsx)(_,{}),Object(u.jsx)(h,{isOpen:a,onClose:le,onUpdateUser:function(e){E.setUserInfo(e).then((function(e){return M(e)})).then((function(){return le()})).catch((function(e){console.log(e),re(S),setTimeout((function(){return re(y)}),3e3)}))},saveButtonClick:se,saveButton:ie}),Object(u.jsx)(O,{isOpen:p,onClose:le,onUpdateAvatar:function(e){E.setUserAvatar(e).then((function(e){M(e)})).then((function(){return le()})).catch((function(e){console.log(e),re(S),setTimeout((function(){return re(y)}),3e3)}))},saveButtonClick:se,saveButton:ie}),Object(u.jsx)(x,{isOpen:C,onClose:le,onAddPlace:function(e){E.setNewCard(e).then((function(e){return W([e].concat(Object(r.a)(Q)))})).then((function(){return le()})).catch((function(e){console.log(e),re(S),setTimeout((function(){return re(y)}),3e3)}))},saveButtonClick:se,saveButton:ie}),Object(u.jsx)(g,{card:R,isOpen:U,onClose:le,onCardDelete:function(e){E.deleteCard(e._id).then((function(){return W(Q.filter((function(t){return t._id!==e._id})))})).then((function(){return le()})).catch((function(e){console.log(e)}))},saveButtonClick:se,saveButton:ie}),Object(u.jsx)(f,{card:R,isOpen:D,onClose:le})]})})};i.a.render(Object(u.jsx)(o.a.StrictMode,{children:Object(u.jsx)(P,{})}),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.151c800c.chunk.js.map